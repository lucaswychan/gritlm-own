  0%|                                                                                                                      | 0/755 [00:00<?, ?it/s]05/31/2025 13:10:54 - INFO - training.gradcache_trainer -   model dtype: torch.bfloat16
05/31/2025 13:11:18 - INFO - training.gradcache_trainer -   loss_emb_p dtype: torch.bfloat16
05/31/2025 13:11:18 - INFO - training.gradcache_trainer -   loss_emb_q dtype: torch.bfloat16
  0%|▏                                                                                                           | 1/755 [00:24<5:05:11, 24.29s/it]05/31/2025 13:11:18 - INFO - training.gradcache_trainer -   model dtype: torch.bfloat16
{'loss': 28.625, 'learning_rate': 4.347826086956522e-07, 'epoch': 0.0}
05/31/2025 13:11:38 - INFO - training.gradcache_trainer -   loss_emb_p dtype: torch.bfloat16
05/31/2025 13:11:38 - INFO - training.gradcache_trainer -   loss_emb_q dtype: torch.bfloat16
  0%|▎                                                                                                           | 2/755 [00:44<4:34:26, 21.87s/it]05/31/2025 13:11:38 - INFO - training.gradcache_trainer -   model dtype: torch.bfloat16
{'loss': 28.5, 'learning_rate': 8.695652173913044e-07, 'epoch': 0.0}
05/31/2025 13:11:55 - INFO - training.gradcache_trainer -   loss_emb_p dtype: torch.bfloat16
05/31/2025 13:11:55 - INFO - training.gradcache_trainer -   loss_emb_q dtype: torch.bfloat16
  0%|▍                                                                                                           | 3/755 [01:02<4:09:26, 19.90s/it]05/31/2025 13:11:56 - INFO - training.gradcache_trainer -   model dtype: torch.bfloat16
{'loss': 30.25, 'learning_rate': 1.3043478260869566e-06, 'epoch': 0.0}
05/31/2025 13:12:12 - INFO - training.gradcache_trainer -   loss_emb_p dtype: torch.bfloat16
05/31/2025 13:12:12 - INFO - training.gradcache_trainer -   loss_emb_q dtype: torch.bfloat16
Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/wychanbu/gritlm/gritlm/training/run.py", line 348, in <module>
    main()
  File "/home/wychanbu/gritlm/gritlm/training/run.py", line 330, in main
    trainer.train()
  File "/home/wychanbu/gritlm/.gritvenv/lib/python3.10/site-packages/transformers/trainer.py", line 1539, in train
    return inner_training_loop(
  File "/home/wychanbu/gritlm/gritlm/training/gradcache_trainer.py", line 607, in _inner_training_loop
    assert torch.allclose(loss_emb_q, loss_emb_p), f"{loss_emb_q} != {loss_emb_p}"
AssertionError: 29.375 != 29.25
[rank0]: Traceback (most recent call last):
[rank0]:   File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
[rank0]:     return _run_code(code, main_globals, None,
[rank0]:   File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
[rank0]:     exec(code, run_globals)
[rank0]:   File "/home/wychanbu/gritlm/gritlm/training/run.py", line 348, in <module>
[rank0]:     main()
[rank0]:   File "/home/wychanbu/gritlm/gritlm/training/run.py", line 330, in main
[rank0]:     trainer.train()
[rank0]:   File "/home/wychanbu/gritlm/.gritvenv/lib/python3.10/site-packages/transformers/trainer.py", line 1539, in train
[rank0]:     return inner_training_loop(
[rank0]:   File "/home/wychanbu/gritlm/gritlm/training/gradcache_trainer.py", line 607, in _inner_training_loop
[rank0]:     assert torch.allclose(loss_emb_q, loss_emb_p), f"{loss_emb_q} != {loss_emb_p}"
[rank0]: AssertionError: 29.375 != 29.25
